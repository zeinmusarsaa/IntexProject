<!DOCTYPE html>
<html lang="en">
    <head>
        <!-- Required meta tags -->
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
        <title>Corona Admin</title>
        <!-- plugins:css -->
        <link rel="stylesheet" href="/vendors/mdi/css/materialdesignicons.min.css">
        <link rel="stylesheet" href="/vendors/css/vendor.bundle.base.css">
        <!-- endinject -->
        <!-- Plugin css for this page -->
        <link rel="stylesheet" href="/vendors/jvectormap/jquery-jvectormap.css">
        <link rel="stylesheet" href="/vendors/flag-icon-css/css/flag-icon.min.css">
        <link rel="stylesheet" href="/vendors/owl-carousel-2/owl.carousel.min.css">
        <link rel="stylesheet" href="/vendors/owl-carousel-2/owl.theme.default.min.css">
        <!-- End plugin css for this page -->
        <!-- inject:css -->
        <!-- endinject -->
        <!-- Layout styles -->
        <link rel="stylesheet" href="/css/style.css">
        <!-- End layout styles -->
        <link rel="shortcut icon" href="/images/favicon.png" />
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
      </head>

<body>
    <div class="container-scroller">
        <!-- partial:partials/_sidebar.html -->
        <nav class="sidebar sidebar-offcanvas" id="sidebar">
          <ul class="nav">
            <li class="nav-item profile">
              <button style="color: white;" class="btn-block navbar-toggler navbar-toggler align-self-center" type="button" data-toggle="minimize">
                <span class="mdi mdi-menu"></span>
              </button>
              <div class="profile-desc">
                <div class="profile-pic">
                  <div class="count-indicator">
                    <img class="img-xs rounded-circle " src="/images/faces/face15.jpg" alt="">
                    <span class="count bg-success"></span>
                  </div>
                  <div class="profile-name">
                    <h5 class="mb-0 font-weight-normal" id="username"></h5>
                  </div>
                </div>
                <a href="#" id="profile-dropdown" data-toggle="dropdown"><i class="mdi mdi-dots-vertical"></i></a>
                <div class="dropdown-menu dropdown-menu-right sidebar-dropdown preview-list" aria-labelledby="profile-dropdown">
                  <div class="dropdown-divider"></div>
                  <a href="#" class="dropdown-item preview-item">
                    <div class="preview-thumbnail">
                      <div class="preview-icon bg-dark rounded-circle">
                        <i class="mdi mdi-calendar-today text-success"></i>
                      </div>
                    </div>
                    <div class="preview-item-content">
                      <p class="preview-subject ellipsis mb-1 text-small">Log Out</p>
                    </div>
                  </a>
                </div>
              </div>
            </li>
            <li class="nav-item nav-category">
              <span class="nav-link">Navigation</span>
            </li>
            <li class="nav-item menu-items">
              <a class="nav-link" href="index.ejs">
                <span class="menu-icon">
                  <i class="mdi mdi-speedometer"></i>
                </span>
                <span class="menu-title">Home</span>
              </a>
            </li>
            <li class="nav-item menu-items">
              <a class="nav-link" href="index.ejs">
                <span class="menu-icon">
                  <i class="mdi mdi-speedometer"></i>
                </span>
                <span class="menu-title">Dashboard</span>
              </a>
            </li>
            <li class="nav-item menu-items">
              <a class="nav-link">
                <span class="menu-icon">
                  <i class="mdi mdi-playlist-play"></i>
                </span>
                <form action="/survey" method="get"><button class="btn-inverse-info" type="submit"><span class="menu-title">Survey</span></button></form>
              </a>
            </li>
            <li class="nav-item menu-items">
              <a class="nav-link" href="pages/tables/basic-table.html">
                <span class="menu-icon">
                  <i class="mdi mdi-table-large"></i>
                </span>
                <span class="menu-title">Report</span>
              </a>
            </li>
            <li class="nav-item menu-items">
              <a class="nav-link" data-toggle="collapse" href="#auth" aria-expanded="false" aria-controls="auth">
                <span class="menu-icon">
                  <i class="mdi mdi-security"></i>
                </span>
                <span class="menu-title">Account</span>
                <i class="menu-arrow"></i>
              </a>
              <div class="collapse" id="auth">
                <ul class="nav flex-column sub-menu">
                  <li class="nav-item"><form action="/login" method="get"><button class="btn-inverse-info" type="submit">Login</button></form></li>
                  <li class="nav-item"><form action="/register" method="get"><button class="btn-inverse-info" type="submit">Register</button></form></li>
                </ul>
              </div>
            </li>
          </ul>
        </nav>
        
    <div class="container-scroller">
        <div class="container-fluid page-body-wrapper">
            <div class="main-panel">
                <div class="row">
                    <div class="grid-margin stretch-card">
                        <div class="card">
                            <div class="card-body">
                

                                <form id="formData" name="surveyForm" action="/submit" method="post">

                                    <label for="origin">Current Location: </label>
                                    <span id="originText">Detecting...</span><br><br>
                                    <!-- Age -->
                                    <label for="age">Age: </label>
                                    <input type="number" id="age" name="age" min="0" max="100" required><br>
                            
                                    <!-- Gender -->
                                    <label for="gender">Gender: </label>
                                    <input type="radio" id="genderMale" name="gender" value="Male"><label for="genderMale"> Male</label>
                                    <input type="radio" id="genderFemale" name="gender" value="Female"><label for="genderFemale"> Female</label>
                                    <input type="radio" id="genderOther" name="gender" value="Other"><label for="genderOther"> Other</label><br><br>
                            
                                    <!-- Relationship Status -->
                                    <label for="relationshipStatus">Relationship Status: </label>
                                    <input type="radio" id="relationshipStatusYes" name="relationshipStatus" value="In a relationship"><label for="relationshipStatusYes"> In a relationship</label>
                                    <input type="radio" id="relationshipStatusSingle" name="relationshipStatus" value="Single"><label for="relationshipStatusSingle"> Single</label>
                                    <input type="radio" id="relationshipStatusMarried" name="relationshipStatus" value="Married"><label for="relationshipStatusMarried"> Married</label>
                                    <input type="radio" id="relationshipStatusDivorced" name="relationshipStatus" value="Divorced"><label for="relationshipStatusDivorced"> Divorced</label><br><br>
                            
                                    <!-- Occupation -->
                                    <label for="occupation">Occupation: </label>
                                    <input type="radio" id="occupationUniStud" name="occupation" value="University Student"><label for="occupationUniStud"> University Student</label>
                                    <input type="radio" id="occupationSchStud" name="occupation" value="School Student"><label for="occupationSchStud"> School Student</label>
                                    <input type="radio" id="occupationSalWrkr" name="occupation" value="Salaried Worker"><label for="occupationSalWrkr"> Salaried Worker</label>
                                    <input type="radio" id="occupationRetired" name="occupation" value="Retired"><label for="occupationRetired"> Retired</label><br><br>
                            
                                    <!-- Media User -->
                                    <label for="mediaUser">Do you use social media? </label>
                                    <input type="radio" id="mediaUserYes" name="mediaUser" value="Yes"><label for="mediaUserYes"> Yes</label>
                                    <input type="radio" id="mediaUserNo" name="mediaUser" value="No"><label for="mediaUserNo"> No</label><br><br>
                            
                                    <!-- Average Time Spent on Social Media Every Day -->
                                    <label for="avgTime">Average time spent on social media every day: </label>
                                    <select name="avgTime" id="avgTime">
                                        <option value="Less than an Hour">Less than an Hour</option>
                                        <option value="Between 1 and 2 hours">Between 1 and 2 hours</option>
                                        <option value="Between 2 and 3 hours">Between 2 and 3 hours</option>
                                        <option value="Between 3 and 4 hours">Between 3 and 4 hours</option>
                                        <option value="Between 4 and 5 hours">Between 4 and 5 hours</option>
                                        <option value="More than 5 hours">More than 5 hours</option>
                                    </select><br><br>
                            
                                    <!-- How often do you use social media without a specific purpose? -->
                                    <label for="noPurpose">How often do you use social media without a specific purpose? </label>
                                    <ul class="likert">
                                        <div class="slidecontainer">
                                        <p>1 - Not Often<input type="range" name="noPurpose" min="1" max="5" value="3">5 - Very Often</p>
                                        </div>
                                    </ul>
                            
                                    <!-- How often do you get distracted by social media when you are busy doing something? -->
                                    <label for="distractionFreq">How often do you get distracted by social media when you are busy? </label>
                                    <ul class="likert">
                                        <div class="slidecontainer">
                                            <p>1 - Not Often<input type="range" name="distractionFreq" min="1" max="5" value="3">5 - Very Often</p>
                                        </div>
                                    </ul>
                            
                                    <!-- Do you feel restless if you haven’t used social media in a while? -->
                                    <label for="restlessLvl">Do you feel restless if you haven’t used social media in a while? </label>
                                    <ul class="likert">
                                        <div class="slidecontainer">
                                            <p>1 - Not Often<input type="range" min="1" name="restlessLvl" max="5" value="3">5 - Very Often</p>
                                        </div>
                                    </ul>
                            
                                    <!-- How easily distracted are you? -->
                                    <label for="distractionSusceptability">How easily distracted are you? </label>
                                    <ul class="likert">
                                        <div class="slidecontainer">
                                            <p>1 - Not Easily Distracted<input type="range" name="distractionSusceptability" min="1" max="5" value="3">5 - Very Easily Distraced</p>
                                        </div>
                                    </ul>
                            
                                    <!-- How much are you bothered by worries? -->
                                    <label for="botheredByWorries">How much are you bothered by worries? </label>
                                    <ul class="likert">
                                        <div class="slidecontainer">
                                            <p>1 - Not Bothered<input type="range" name="botheredByWorries" min="1" max="5" value="3">5 - Very Bothered</p>
                                        </div>
                                    </ul>
                            
                                    <!-- Do you find it difficult to concentrate on things? -->
                                    <label for="difficultyConcentrating">Do you find it difficult to concentrate on things? </label>
                                    <ul class="likert">
                                        <div class="slidecontainer">
                                            <p>1 - Not Often<input type="range" name="difficultyConcentrating" min="1" max="5" value="3">5 - Very Often</p>
                                        </div>
                                    </ul>
                            
                                    <!-- How often do you compare yourself to other successful people through the use of social media? -->
                                    <label for="comparisonFreq">How often do you compare yourself to other successful people on social media? </label>
                                    <ul class="likert">
                                        <div class="slidecontainer">
                                            <p>1 - Not Often<input type="range" name="comparisonFreq" min="1" max="5" value="3">5 - Very Often</p>
                                        </div>
                                    </ul>
                            
                                    <!-- Following the previous question, how do you feel about these comparisons, generally speaking? -->
                                    <label for="comparisonFeeling">How do you feel about comparing yourself to others on social media? </label>
                                    <ul class="likert">
                                        <div class="slidecontainer">
                                            <p>1 - Not Good<input type="range" name="comparisonFeeling" min="1" max="5" value="3">5 - Very Good</p>
                                        </div>
                                    </ul>
                            
                                    <!-- How often do you look to seek validation from features of social media? -->
                                    <label for="validationFreq">How often do you seek validation from features of social media? </label>
                                    <ul class="likert">
                                        <div class="slidecontainer">
                                            <p>1 - Not Often<input type="range" name="validationFreq" min="1" max="5" value="3">5 - Very Often</p>
                                        </div>
                                    </ul>
                            
                                    <!-- How often do you feel depressed or down? -->
                                    <label for="depressionFreq">How often do you feel depressed or down? </label>
                                    <ul class="likert">
                                        <div class="slidecontainer">
                                            <p>1 - Not Often<input type="range" name="depressionFreq" min="1" max="5" value="3">5 - Very Often</p>
                                        </div>
                                    </ul>
                            
                                    <!-- How frequently does your interest in daily activities fluctuate? -->
                                    <label for="dailyInterestFluctuation">How frequently does your interest in daily activities fluctuate? </label>
                                    <ul class="likert">
                                        <div class="slidecontainer">
                                            <p>1 - Not Often<input type="range" name="dailyInterestFluctuation" min="1" max="5" value="3">5 - Very Often</p>
                                        </div>
                                    </ul>
                            
                                    <!-- How often do you face issues regarding sleep? -->
                                    <label for="sleepProblemsFreq">How often do you face issues regarding sleep? </label>
                                    <ul class="likert">
                                    <div class="slidecontainer">
                                        <p>1 - Not Often<input type="range" name="sleepProblemsFreq" min="1" max="5" value="3">5 - Very Often</p>
                                        </div>
                                    </ul>
                            
                                    <label for="mentalHealthScore">Your Mental Health Score: </label>
                                    <span id="mentalHealthScoreText">Calculating...</span><br><br>
                            
                                    <!-- Submit button -->
                                    <input type="submit" value="Submit">
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
                            
            </div>

        </div>
    
</div>
    <script>
        function updateCurrentLocation() {
            // Use the Geolocation API to get the user's current location
            navigator.geolocation.getCurrentPosition(
                position => {
                    const latitude = position.coords.latitude;
                    const longitude = position.coords.longitude;

                    // Use a reverse geocoding service to get the city based on coordinates
                    fetch(`https://geocode.xyz/${latitude},${longitude}?json=1`)
                        .then(response => response.json())
                        .then(data => {
                            //The code below sets the city according to the user's location
                            // const city = data.city || 'Unknown';
                            const city = 'Provo';
                            document.getElementById('originText').innerText = city;
                        })
                        .catch(error => {
                            console.error('Error fetching location data', error);
                            document.getElementById('originText').innerText = 'Unknown';
                        });
                },
                error => {
                    console.error('Error getting location', error);
                    document.getElementById('originText').innerText = 'Unknown';
                }
            );
        }

        // Call the function to update current location on page load
        updateCurrentLocation();

        // Function to calculate the score
        function calculateScore(formData) {
            let total = 0;

            // Questions to exclude from the total
            const excludedQuestions = ['age', 'gender', 'relationshipStatus', 'occupation', 'mediaUser', 'avgTime', 'comparisonFeeling'];

            // Sum all Likert scale values except those excluded
            for (const key in formData) {
                if (formData.hasOwnProperty(key) && !excludedQuestions.includes(key)) {
                    const value = parseInt(formData[key]);
                    if (!isNaN(value)) {
                        total += value;
                    } else {
                        console.error(`Invalid value for question ${key}: ${formData[key]}`);
                        return NaN; // Return NaN if there's an invalid value
                    }
                }
            }

            // Calculate the score based on a simplified formula
            const intermediateScore = (total - 11) / 12;
            const finalScore = 100 - intermediateScore;

            return finalScore.toFixed(2); // Return the score rounded to 2 decimal places
        }

        // Function to handle form submission
        function handleSubmit(event) {
            event.preventDefault(); // Prevents the default form submission

            // Get form data
            const formData = {};

            // Loop through form elements and extract values
            const formElements = document.getElementById('formData').elements;
            for (let i = 0; i < formElements.length; i++) {
                const element = formElements[i];

                // Check if the element has a name and is a likert input
                if (element.name && element.type === 'range') {
                    formData[element.name] = element.value;
                }
            }

            updateCurrentLocation();

            // Calculate the score
            const score = calculateScore(formData);

            // Display the score
            document.getElementById('mentalHealthScoreText').innerText = score + '%';

            // Log or use the score as needed
            console.log('Calculated Score:', score);
        }

        // Attach event listener to the form
        document.getElementById('formData').addEventListener('submit', handleSubmit);
    </script>
    
      <script src="/vendors/js/vendor.bundle.base.js"></script>
      <!-- endinject -->
      <!-- Plugin js for this page -->
      <script src="/vendors/chart.js/Chart.min.js"></script>
      <script src="/vendors/progressbar.js/progressbar.min.js"></script>
      <script src="/vendors/jvectormap/jquery-jvectormap.min.js"></script>
      <script src="/vendors/jvectormap/jquery-jvectormap-world-mill-en.js"></script>
      <script src="/vendors/owl-carousel-2/owl.carousel.min.js"></script>
      <!-- End plugin js for this page -->
      <!-- inject:js -->
      <script src="/js/off-canvas.js"></script>
      <script src="/js/hoverable-collapse.js"></script>
      <script src="/js/misc.js"></script>
      <script src="/js/settings.js"></script>
      <script src="/js/todolist.js"></script>
      <!-- endinject -->
      <!-- Custom js for this page -->
      <script src="/js/dashboard.js"></script>
      <!-- End custom js for this page -->
      <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL" crossorigin="anonymous"></script>
</body>
</html>